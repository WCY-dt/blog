---
layout: post
title:  "【Codeforces】#738"
date:   2021-08-16 00:00:00 +0800
categories: 算法
tags: codeforces
comments: 1
mathjax: true
copyrights: 原创
---

[Codeforces Round #738 (Div. 2)](https://codeforces.com/contest/1559)

# A. Mocha and Math

<div class="wrapper"><details><summary><div align="right" top="0px" right="0px" position="absolute" class="copybutton cpbtn-expand"><i class="material-icons">expand_circle_down</i><p>点击查看题目</p></div></summary>
<div class="cf">
    <tit><a href="https://codeforces.com/contest/1559/problem/A">A. Mocha and Math</a></tit>
<lim>1000 ms    256 Mb</lim>
<pro>Mocha is a young girl from high school. She has learned so much interesting knowledge from her teachers, especially her math teacher. Recently, Mocha is learning about binary system and very interested in bitwise operation.<br/>
This day, Mocha got a sequence a of length $n$. In each operation, she can select an arbitrary interval $[l,r]$ and for all values $i (0\leq i\leq r−l)$, replace $a_{l+i}$ with $a_{l+i}\&a_{r−i}$ at the same time, where & denotes the bitwise <em>AND</em> operation. This operation can be performed any number of times.<br/>
For example, if $n=5$, the array is $[a_1,a_2,a_3,a_4,a_5]$, and Mocha selects the interval $[2,5]$, then the new array is $[a_1,a_2\&a_5,a_3\&a_4,a_4\&a_3,a_5\&a_2]$.<br/>
Now Mocha wants to minimize the maximum value in the sequence. As her best friend, can you help her to get the answer?
</pro>
<in>
Each test contains multiple test cases.<br/>
The first line contains a single integer $t (1\leq t
\leq100)$ — the number of test cases. Each test case consists of two lines.<br/>
The first line of each test case contains a single integer $n (1\leq n\leq100)$ — the length of the sequence.<br/>
The second line of each test case contains $n$ integers $a_1,a_2,\cdots,a_n (0\leq a_i\leq10^9)$.
</in>
<out>
For each test case, print one integer — the minimal value of the maximum value in the sequence.
</out>
<sample>
<num>1</num>
<in>
4<br/>
2<br/>
1 2<br/>
3<br/>
1 1 3<br/>
4<br/>
3 11 3 7<br/>
5<br/>
11 7 15 3 7
</in>
<out>
0<br/>
1<br/>
3<br/>
3
</out>
<note>
In the first test case, Mocha can choose the interval $[1,2]$, then the sequence becomes $[0,0]$, where the first element is $1\&2$, and the second element is $2\&1$.<br/>
In the second test case, Mocha can choose the interval $[1,3]$, then the sequence becomes $[1,1,1]$, where the first element is $1\&3$, the second element is $1\&1$, and the third element is $3\&1$.
</note>
</sample>
</div>
</details></div>

Combine all together.

# B. Mocha and Red and Blue

<div class="wrapper"><details><summary><div align="right" top="0px" right="0px" position="absolute" class="copybutton cpbtn-expand"><i class="material-icons">expand_circle_down</i><p>点击查看题目</p></div></summary>
<div class="cf">
    <tit><a href="https://codeforces.com/contest/1559/problem/B">B. Mocha and Red and Blue</a></tit>
<lim>1000 ms    256 Mb</lim>
<pro>
As their story unravels, a timeless tale is told once again...<br/>
Shirahime, a friend of Mocha's, is keen on playing the music game Arcaea and sharing Mocha interesting puzzles to solve. This day, Shirahime comes up with a new simple puzzle and wants Mocha to solve them. However, these puzzles are too easy for Mocha to solve, so she wants you to solve them and tell her the answers. The puzzles are described as follow.<br/>
There are n squares arranged in a row, and each of them can be painted either red or blue.<br/>
Among these squares, some of them have been painted already, and the others are blank. You can decide which color to paint on each blank square.<br/>
Some pairs of adjacent squares may have the same color, which is imperfect. We define the imperfectness as the number of pairs of adjacent squares that share the same color.<br/>
For example, the imperfectness of "BRRRBBR" is 3, with "BB" occurred once and "RR" occurred twice.<br/>
Your goal is to minimize the imperfectness and print out the colors of the squares after painting.
</pro>
<in>
Each test contains multiple test cases.<br/>
The first line contains a single integer $t (1\leq t\leq100)$ — the number of test cases. Each test case consists of two lines.<br/>
The first line of each test case contains an integer $n (1\leq n\leq100)$ — the length of the squares row.<br/>
The second line of each test case contains a string s with length $n$, containing characters 'B', 'R' and '?'. Here 'B' stands for a blue square, 'R' for a red square, and '?' for a blank square.
</in>
<out>
For each test case, print a line with a string only containing 'B' and 'R', the colors of the squares after painting, which imperfectness is minimized. If there are multiple solutions, print any of them.
</out>
<sample>
<num>1</num>
<in>
5<br/>
7<br/>
?R???BR<br/>
7<br/>
???R???<br/>
1<br/>
?<br/>
1<br/>
B<br/>
10<br/>
?R??RB??B?
</in>
<out>
BRRBRBR<br/>
BRBRBRB<br/>
B<br/>
B<br/>
BRRBRBBRBR
</out>
<note>
In the first test case, if the squares are painted "BRRBRBR", the imperfectness is 1 (since squares 2 and 3 have the same color), which is the minimum possible imperfectness.
</note>
</sample>
</div>
</details></div>

Greedy. Just follow R with B and follow B with R.

# C. Mocha and Hiking

<div class="wrapper"><details><summary><div align="right" top="0px" right="0px" position="absolute" class="copybutton cpbtn-expand"><i class="material-icons">expand_circle_down</i><p>点击查看题目</p></div></summary>
<div class="cf">
    <tit><a href="https://codeforces.com/contest/1559/problem/C">C. Mocha and Hiking</a></tit>
<lim>1000 ms    256 Mb</lim>
<pro>
The city where Mocha lives in is called Zhijiang. There are $n+1$ villages and $2n−1$ directed roads in this city.<br/>
There are two kinds of roads:<br/>
<li>$n−1$ roads are from village $i$ to village $i+1$, for all $1\leq i\leq n−1$.</li>
<li>$n$ roads can be described by a sequence $a_1,\cdots,a_n$. If $a_i=0$, the i-th of these roads goes from village $i$ to village $n+1$, otherwise it goes from village $n+1$ to village $i$, for all $1\leq i\leq n$.</li>
Mocha plans to go hiking with Taki this weekend. To avoid the trip being boring, they plan to go through every village exactly once. They can start and finish at any villages. Can you help them to draw up a plan?
</pro>
<in>
Each test contains multiple test cases.<br/>
The first line contains a single integer $t (1\leq t\leq20)$ — the number of test cases. Each test case consists of two lines.<br/>
The first line of each test case contains a single integer $n (1\leq n\leq104)$ — indicates that the number of villages is $n+1$.<br/>
The second line of each test case contains $n$ integers $a_1,a_2,\cdots,a_n (0\leq a_i\leq1)$. If $a_i=0$, it means that there is a road from village $i$ to village $n+1$. If $a_i=1$, it means that there is a road from village $n+1$ to village $i$.<br/>
It is guaranteed that the sum of $n$ over all test cases does not exceed $10^4$.
</in>
<out>
For each test case, print a line with $n+1$ integers, where the i-th number is the i-th village they will go through. If the answer doesn't exist, print −1.<br/>
If there are multiple correct answers, you can print any one of them.
</out>
<sample>
<num>1</num>
<in>
2<br/>
3<br/>
0 1 0<br/>
3<br/>
1 1 0
</in>
<out>
1 4 2 3 <br/>
4 1 2 3 
</out>
<note>
In the first test case, the city looks like the following graph:<br/>
<img src="https://espresso.codeforces.com/c356122b85e505fc5f86a59d730025c06eb046bb.png"><br/>
So all possible answers are (1→4→2→3), (1→2→3→4).<br/>
In the second test case, the city looks like the following graph:<br/>
<img src="https://espresso.codeforces.com/1d5b2a263d4625ce2b3266a68c08294c83eb9308.png"><br/>
So all possible answers are (4→1→2→3), (1→2→3→4), (3→4→1→2), (2→3→4→1).
</note>
</sample>
</div>
</details></div>

If $a_0=1$, output $n+1, 1,2,\cdots,n$

Else if $a_n=0$, output $1,2,\cdots,n$

Else find $k$ where $a_k=1$ and $a_{k-1}=0$, output $1,2,\cdots,k-1,n+1,k,k+1,\cdots,n$

Otherwise output $-1$

# D. Mocha and Diana

<div class="wrapper"><details><summary><div align="right" top="0px" right="0px" position="absolute" class="copybutton cpbtn-expand"><i class="material-icons">expand_circle_down</i><p>点击查看题目</p></div></summary>
<div class="cf">
    <tit><a href="https://codeforces.com/contest/1559/problem/D2">D. Mocha and Diana</a></tit>
<lim>1000 ms    256 Mb</lim>
<pro>
A forest is an undirected graph without cycles (not necessarily connected).<br/>
Mocha and Diana are friends in Zhijiang, both of them have a forest with nodes numbered from 1 to $n$, and they would like to add edges to their forests such that:<br/>
<li>After adding edges, both of their graphs are still forests.</li>
<li>They add the same edges. That is, if an edge $(u,v)$ is added to Mocha's forest, then an edge $(u,v)$ is added to Diana's forest, and vice versa.</li>
Mocha and Diana want to know the maximum number of edges they can add, and which edges to add.
</pro>
<in>
The first line contains three integers $n$, $m_1$ and $m_2$ ($1\leq n\leq105, 0\leq m_1,m_2<n$) — the number of nodes and the number of initial edges in Mocha's forest and Diana's forest.<br/>
Each of the next $m_1$ lines contains two integers $u$ and $v$ ($1\leq u,v\leq n, u\neq v$) — the edges in Mocha's forest.<br/>
Each of the next $m_2$ lines contains two integers $u$ and $v$ ($1\leq u,v\leq n, u\neq v$) — the edges in Diana's forest.
</in>
<out>
The first line contains only one integer h, the maximum number of edges Mocha and Diana can add.<br/>
Each of the next h lines contains two integers $u$ and $v$ ($1\leq u,v\leq n, u\neq v$) — the edge you add each time.<br/>
If there are multiple correct answers, you can print any one of them.
</out>
<sample>
<num>1</num>
<in>
3 2 2<br/>
1 2<br/>
2 3<br/>
1 2<br/>
1 3
</in>
<out>
0
</out>
<note>
We cannot add any edge.
</note>
</sample>
<sample>
<num>2</num>
<in>
5 3 2<br/>
5 4<br/>
2 1<br/>
4 3<br/>
4 3<br/>
1 4
</in>
<out>
1<br/>
2 4
</out>
<br/><br/>
<note>
The initial forests are as follows.<br/>
<img src="https://espresso.codeforces.com/5ea32ef529bf0022d2684a67c6e77148e1ff0234.png" width="40%"><br/>
We can add an edge (2,4).<br/>
<img src="https://espresso.codeforces.com/fe7c4e9def63c34eeff87ac6a1833cac6e94f454.png" width="40%">
</note>
</sample>
<sample>
<num>3</num>
<in>
8 1 2<br/>
1 7<br/>
2 6<br/>
1 5<br/><br/><br/>
</in>
<out>
5<br/>
5 2<br/>
2 3<br/>
3 4<br/>
4 7<br/>
6 8
</out>
</sample>
</div>
</details></div>

The answer is at most `N - 1 - max(m1, m2)`, and it is always achievable.

We can just arbitrarily add valid edges. Maintain the two forests using DSU. And then repeatedlly find two verticles that can be connected without creating a cycle.

We only need to check every pair of verticles once.

$O(n^2)$: Iterate every pair of edge

$O(n\log n)$: Vertex v is in a comp of size a in Mocha’s forest and size b in Diana’s forest. We only need to check min(a, n-b) vertices to find a vertex that can be connected to v, if one exists. 

Until we’ve added `N - 1 - max(m1, m2)`

- pick the smalledt CC in Mocha’s forest
- pick a vertex that satisfy `size(X)+size(Y)-size(X,Y)<N`

# E. Mocha and Stars

<div class="wrapper"><details><summary><div align="right" top="0px" right="0px" position="absolute" class="copybutton cpbtn-expand"><i class="material-icons">expand_circle_down</i><p>点击查看题目</p></div></summary>
<div class="cf">
    <tit><a href="https://codeforces.com/contest/1559/problem/E">E. Mocha and Stars</a></tit>
<lim>2000 ms    256 Mb</lim>
<pro>
Mocha wants to be an astrologer. There are n stars which can be seen in Zhijiang, and the brightness of the i-th star is ai.<br/>
Mocha considers that these n stars form a constellation, and she uses $(a_1,a_2,\cdots,a_n)$ to show its state. A state is called mathematical if all of the following three conditions are satisfied:<br/>
<li>For all $i (1\leq i\leq n)$, $a_i$ is an integer in the range $[l_i,r_i]$.</li>
<li>$\sum\limits_{i=1}^{n}{a_i}\leq m$.</li>
<li>$\gcd(a_1,a_2,\cdots,a_n)=1$.</li>
Here, $\gcd(a_1,a_2,\cdots,a_n)$ denotes the greatest common divisor (GCD) of integers $a_1,a_2,\cdots,a_n$.<br/>
Mocha is wondering how many different mathematical states of this constellation exist. Because the answer may be large, you must find it modulo 998244353.<br/>
Two states $(a_1,a_2,\cdots,a_n)$ and $(b_1,b_2,\cdots,b_n)$ are considered different if there exists $i (1\leq i\leq n)$ such that $a_i\neq b_i$.
</pro>
<in>
The first line contains two integers $n$ and $m (2\leq n\leq 50, 1\leq m\leq 105)$ — the number of stars and the upper bound of the sum of the brightness of stars.<br/>
Each of the next $n$ lines contains two integers $l_i$ and $r_i$ $(1\leq l_i\leq r_i\leq m)$ — the range of the brightness of the i-th star.
</in>
<out>
Print a single integer — the number of different mathematical states of this constellation, modulo 998244353.
</out>
<sample>
<num>1</num>
<in>
2 4<br/>
1 3<br/>
1 2
</in>
<out>
4
</out>
<note>
There are 4 different mathematical states of this constellation:<br/>
<li>$a_1=1, a_2=1$.</li>
<li>$a_1=1, a_2=2$.</li>
<li>$a_1=2, a_2=1$.</li>
<li>$a_1=3, a_2=1$.</li>
</note>
</sample>
<sample>
<num>2</num>
<in>
5 10<br/>
1 10<br/>
1 10<br/>
1 10<br/>
1 10<br/>
1 10
</in>
<out>
251
</out>
</sample>
<sample>
<num>3</num>
<in>
5 100<br/>
1 94<br/>
1 96<br/>
1 91<br/>
4 96<br/>
6 97
</in>
<out>
47464146
</out>
</sample>
</div>
</details></div>

Möbius inversion. Here is a referrence: [Möbius function - Wikipedia](https://en.wikipedia.org/wiki/Möbius_function)

- $\mu(n)=1$ if n is not divisible by any perfect squares and it has an even number of prime factors
- $\mu(n)=-1$ if same,except odd number of prime numbers
- $\mu(n)=0$ if divisible by a square

$f(x)$ be the number of valid squences where all elements are divisible by $x$

the number of sequences with gcd 1 is the sum of $\mu(x)\cdot f(x)$​

$O(NM\log M)$: `dp[i][j]`= the number of ways to use the first $i$ sequences to achieve sum $j$

- `dp[i][0]=dp[i-1][0]`

- `dp[i][j]=dp[i][j-1]-dp[i-1][j-k-1]+dp[i-1][j]`

